@{
    ViewBag.Title = "員工登入系統";
    Layout = "~/Views/Shared/LoginLayout.cshtml";
}


<button class="ui black button mt-2 ml-2 demo4 disapear">
    <i class="icon sign-in"></i>
    隱藏Demo鍵
</button>
<button class="ui black button mt-2 ml-2 demo5 disapear">
    <i class="icon sign-in"></i>
    顯示Demo鍵
</button>

<div class="ui mini modal forgetpwmodal centermodal">
    <i class="close icon"></i>
    <div class="header">
        忘記密碼
    </div>
    <div class="content">
        <form class="ui form">
            <div class="field">
                <label>員工編號：</label>
                <input type="text" class="EmpID" name="EmpID" placeholder="員工編號...">
            </div>
            <div class="field">
                <label>帳號：</label>
                <input type="text" class="EmpEmail" name="ACCtext" placeholder="Email...">
            </div>
            <div class="actions">
                <div class="ui button cancel">取消</div>
                <div class="ui button" onclick="sendchpwreq()">確認發送</div>
            </div>
        </form>
    </div>
   
</div>
<div class="LoginForm ">
    <div class="w-100 border-top"></div>
    <div class="d-flex">
        <div class="EIPLOGO">
            <img class="w-100 h-100" src="~/images/Logo.png" />
        </div>
        <div class="Block2">
            <button class="ui black button w-25  mt-2 demo1">
                <i class="icon sign-in"></i>
                主管
            </button>
            <button class="ui black button w-25 mt-2 demo2">
                <i class="icon sign-in"></i>
                人事
            </button>
            <button class="ui black button w-25 mt-2 demo3">
                <i class="icon sign-in"></i>
                員工
            </button>
            <form class="FormLogin px-4 py-4 formbord ui form mt-5">
                <div>
                    <div class="field ui massive label d-flex justify-content-center">
                        <i class="user outline icon"></i>員工登入系統
                    </div>
                    <div class="field">
                        <label class="inputtext ">帳號：</label>
                        <div class="ui left icon input">
                            <input type="text" placeholder="E-mail..." class="ACCtext" name="ACCtext">
                            <i class="user icon"></i>
                        </div>
                    </div>
                    <div class="field">
                        <label class="inputtext mt-5">密碼：</label>
                        <div class="ui left icon input">
                            <input class="PWtext" name="PWtext" type="password" placeholder="Password..." />
                            <i class="key icon"></i>
                        </div>
                    </div>
                    <div class="mt-5 d-flex justify-content-between">
                        <input type="checkbox" class="mt-1 mr-1" />
                        <label class="RememberME font-weight-bolder mr-5">記住我</label>
                        <div class="ui inverted secondary button w-50 ml-5 mb-2" onclick="showforgetpwmodal()">
                            <span class="mr-2">忘記密碼</span><i class="blue icon question"></i>
                        </div>
                    </div>   
                    <div class="form-group mt-2">
                        <button class="ui black button w-100 btnSend mt-2">
                            <i class="icon sign-in"></i>
                            登入
                        </button>
                        <input type="reset" class="resetform" hidden />
                    </div>
                </div>
            </form>
           
        </div>
    </div>
    <div class="bottomblock w-100 border-top"></div>
</div>


@section script{
    <script>
        $(".demo1").click(function () {
            $(".ACCtext").val('boss@gmail.com');
            $(".PWtext").val('123456');
        });
        $(".demo2").click(function () {
            $(".ACCtext").val('abc@gmail.com');
            $(".PWtext").val('123456');
        });
        $(".demo3").click(function () {
            $(".ACCtext").val('abcd@gmail.com');
            $(".PWtext").val('123456');
        });
        $(".demo4").click(function () {
            $(".demo1").attr('hidden', true);
            $(".demo2").attr('hidden', true);
            $(".demo3").attr('hidden', true);
        });
        $(".demo5").click(function () {
            $(".demo1").attr('hidden', false);
            $(".demo2").attr('hidden', false);
            $(".demo3").attr('hidden', false);
         });
        $(".btnSend").click(function () {
            event.preventDefault();
            $.ajax({
                url: "/Home/AccPwCheck",
                data: {
                    "信箱": $(".ACCtext").val(),
                    "EmployeePW": $(".PWtext").val(),
                    "記住我": $(".RememberME").val()
                },
                method: "get",
                success: function (data) {
                    if (data.status != "") {
                        setTimeout(function () { window.location.href = "/Home/Index"; }, 1000);
                        swal("登入成功", "請稍後...", "success");
                    } else {
                        $(".resetform").click();
                        swal("登入失敗", "帳號或密碼錯誤,請重新登入...", "error");
                    }
                }
            })

        });


        function showforgetpwmodal() {
            $(".forgetpwmodal").modal('show');

        };

        function sendchpwreq() {
            if ($(".EmpEmail").val() == "" || $(".EmpID").val() == "") {
                swal("密碼重置", "欄位請勿留空...", "error");
            }   
                      $.ajax({
                          url: "/Home/forgetpw",
                          data: {
                              "信箱": $(".EmpEmail").val(),
                              "員工編號": $(".EmpID").val()                            
                          },
                          method: "get",
                          success: function (data) {
                              swal('密碼重置', `密碼重置為'${data}',請於登入後盡速修改個人密碼!`, 'warning');
                              $(".EmpEmail").val("");
                              $(".EmpID").val("");
                              $(".forgetpwmodal").modal('hide');
                          }
      
                });   
       
        }

    </script>
}