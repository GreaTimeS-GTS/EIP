
<div class="ui pointing secondary menu">
    <a class="item active bigTab專案列表" data-tab="first">專案列表</a>
    <a class="item bigTab建立專案" data-tab="second">建立專案</a>
    <a class="item bigTab專案控管" data-tab="third" @*hidden*@>專案控管</a>
</div>
<div class="ui tab segment active" data-tab="first" id="pjListView"></div>
<div class="ui tab segment " data-tab="second">
    <div class="ui top attached tabular menu">
        <a class="item active" data-tab="second/a" id="tab總表">總表</a>
        <a class="item" data-tab="second/b" id="tab建立初審">建立初審</a>
        <a class="item" data-tab="second/c" id="tab建立複審" hidden>建立複審</a>
        <a class="item" data-tab="second/e" id="tab專案初審審核">專案初審審核</a>
        <a class="item" data-tab="second/f" id="tab專案初審通過">專案初審通過</a>
        <a class="item" data-tab="second/d" id="tab專案複審審核">專案複審審核</a>
    </div>
    <div class="ui bottom attached tab segment active" data-tab="second/a" id="content總表">
        <div class="pj專案建立審核沒有建立中專案"></div>
        <table class="ui selectable celled table">
            <thead class="appendPjDataFromSql-th"></thead>
            <tbody class="appendPjDataFromSql-tb"></tbody>
        </table>
    </div>
    <div class="ui bottom attached tab segment " data-tab="second/d" id="content專案複審審核">
        <div class="pj專案建立審核沒有建立中專案"></div>
        <table class="ui selectable celled table">
            <thead class="appendPjDataFromSql-th2"></thead>
            <tbody class="appendPjDataFromSql-tb2"></tbody>
        </table>
    </div>
    <div class="ui bottom attached tab segment " data-tab="second/e" id="content專案初審審核">
        <div class="pj專案建立審核沒有建立中專案"></div>
        <table class="ui selectable celled table">
            <thead class="appendPjDataFromSql-th3"></thead>
            <tbody class="appendPjDataFromSql-tb3"></tbody>
        </table>
    </div>
    <div class="ui bottom attached tab segment " data-tab="second/f" id="content專案初審通過">
        <div class="pj專案建立審核沒有建立中專案"></div>
        <table class="ui selectable celled table">
            <thead class="appendPjDataFromSql-th4"></thead>
            <tbody class="appendPjDataFromSql-tb4"></tbody>
        </table>
    </div>
    <div class="ui bottom attached tab segment" data-tab="second/b" id="content建立初審"></div>
    <div class="ui bottom attached tab segment" data-tab="second/c" id="content建立複審"></div>
</div>
<div class="ui tab segment" data-tab="third" id="tab專案控管">
    <div class="ui top attached tabular menu">
        <a class="item active" data-tab="third/a" id="tab專案規劃">專案規劃</a>
        <a class="item" data-tab="third/b" id="tab專案進度">專案進度</a>
        <a class="item" data-tab="third/c" id="tab每日進度">每日進度</a>
        <a class="item" data-tab="third/d" id="tab專案會議記錄">專案會議記錄</a>
    </div>
    <div class="ui bottom attached tab segment active" data-tab="third/a" id="content專案規劃">
        <div class="addPlan"></div>        
    </div>
    <div class="ui bottom attached tab segment" data-tab="third/b" id="content專案進度">
        <table class="ui selectable celled table">
            <thead>
                <tr>
                    <th>日期</th>
                    <th>專案名稱</th>
                    <th>成員姓名</th>
                    <th>回報情況</th>
                    <th>詳細</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Jamie</td>
                    <td>Jamie</td>
                    <td>Jamie</td>
                    <td class="positive">Approved</td>
                    <td class="selectable positive">
                        <a href="#">Approve</a>
                    </td>
                </tr>
                <tr>
                    <td>Jill</td>
                    <td>Jamie</td>
                    <td>Jamie</td>
                    <td class="negative">Denied</td>
                    <td class="selectable negative">
                        <a href="#">Remove</a>
                    </td>
                </tr>
                <tr class="warning">
                    <td>John</td>
                    <td>Jamie</td>
                    <td>Jamie</td>
                    <td>No Action</td>
                    <td class="selectable">
                        <a href="#">Edit</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="ui bottom attached tab segment" data-tab="third/c" id="content每日進度">
        <div class="ui form">
            <div class="fields">
                <div class="four wide field">
                    <label>日期</label>
                    <input type="text" placeholder="First Name">
                </div>
                <div class="two wide field"></div>
                <div class="five wide field"></div>
                <div class="five wide field"></div>
            </div>
            <div class="fields">
                <div class="four wide field">
                    <label>專案名稱</label>
                    <input type="text" placeholder="First Name">
                </div>
                <div class="two wide field"></div>
                <div class="five wide field"></div>
                <div class="five wide field"></div>
            </div>
            <div class="fields">
                <div class="four wide field">
                    <label>工作項目</label>
                    <input type="text" placeholder="First Name">
                </div>
                <div class="two wide field"></div>
                <div class="five wide field"></div>
                <div class="five wide field"></div>
            </div>
            <div class="fields">
                <div class="four wide field">
                    <label>工作內容</label>
                    <input type="text" placeholder="First Name">
                </div>
                <div class="two wide field"></div>
                <div class="five wide field"></div>
                <div class="five wide field"></div>
            </div>
            <div class="fields">
                <div class="four wide field">
                    <label>問題回報</label>
                    <input type="text" placeholder="First Name">
                </div>
                <div class="two wide field"></div>
                <div class="five wide field"></div>
                <div class="five wide field"></div>
            </div>
            <div class="fields mt-3">
                <div class="four wide field d-flex justify-content-end">
                    <button class="ui inverted red button">取消</button>
                    <button class="ui inverted primary button">確認</button>
                </div>
                <div class="twelve wide field d-flex"></div>
            </div>
        </div>
    </div>
    <div class="ui bottom attached tab segment" data-tab="third/d" id="content專案會議記錄">
        <div class="ui form">
            <div class="fields">
                <div class="four wide field">
                    <label>開會日期</label>
                    <input type="text" placeholder="First Name">
                </div>
                <div class="four wide field"></div>
                <div class="four wide field"></div>
                <div class="four wide field"></div>
            </div>
            <div class="fields">
                <div class="four wide field">
                    <label>專案名稱</label>
                    <input type="text" placeholder="First Name">
                </div>
                <div class="four wide field"></div>
                <div class="four wide field"></div>
                <div class="four wide field"></div>
            </div>
            <div class="fields">
                <div class="four wide field">
                    <label>開會內容</label>
                    <textarea type="text" placeholder="First Name"></textarea>
                </div>
                <div class="two wide field">
                    <label>其他備註</label>
                    <textarea type="text" placeholder="First Name"></textarea>
                </div>
                <div class="four wide field d-flex flex-column-reverse">
                    <button class="ui inverted primary button mt-1">確認</button>
                    <button class="ui inverted red button">取消</button>
                </div>
                <div class="six wide field"></div>
            </div>
            @*<div class="fields mt-3">
                <div class="six wide field d-flex justify-content-end">
                    <button class="ui inverted red button">取消</button>
                    <button class="ui inverted primary button">確認</button>
                </div>
                <div class="six wide field d-flex"></div>
            </div>*@
        </div>
    </div>
</div>


@*------------------------彈-----------------------------*@
<div class="ui small modal centermodal" id="pjShowaaaaa">
    <i class="close icon"></i>
    <div class="header">
        專案名稱
    </div>
    <div class="content">
        <p>專案詳細內容</p>
        <div class="ui form">
            <div class="two fields">
                <div class="field">
                    <label>專案經理</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
                <div class="field">
                    <label>專案簡介</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
            </div>
            <div class="two fields">
                <div class="field">
                    <label>專案客戶</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
                <div class="field">
                    <label>專案預算</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
            </div>
            <div class="three fields">
                <div class="field">
                    <label>開始日期</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
                <div class="field">
                    <label>結束日期</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
                <div class="field">
                    <label>預估時間</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
            </div>
            <div class="fields">
                <div class="four wide field">
                    <label>專案成員</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
                <div class="four wide field">
                    <label>部門</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
                <div class="eight wide field">
                    <label>項目名稱</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
            </div>
            <div class="fields">
                <div class="four wide field">
                    <label>專案成員</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
                <div class="four wide field">
                    <label>部門</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
                <div class="eight wide field">
                    <label>項目名稱</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
            </div>
            <div class="fields">
                <div class="four wide field">
                    <label>專案成員</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
                <div class="four wide field">
                    <label>部門</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
                <div class="eight wide field">
                    <label>項目名稱</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
            </div>
        </div>
    </div>
    <div class="actions d-flex justify-content-between">
        <div>
            <div class="ui primary button">規劃</div>
            <div class="ui grey button ml-3">進度</div>
        </div>
        <div>
            <div class="ui red deny button">取消</div>
            <div class="ui positive right labeled icon button" style="width:135px">確認<i class="checkmark icon"></i></div>
        </div>
        @*<div class="ui approve button">Approve</div>
        <div class="ui button">Neutral</div>
        <div class="ui cancel button">Cancel</div>*@
    </div>
</div>

<div class="ui small modal centermodal" id="pj初審單">
    <i class="close icon"></i>
    <div class="header pj初審單header"></div>
    <div class="content">
        <p style="color: #FF6347">初審</p>
        <div class="pj初審單資料"></div>        
    </div>
</div>
<div class="ui small modal centermodal" id="pj複審單">
    <i class="close icon"></i>
    <div class="header">
        複審詳細內容
    </div>
    <div class="content">
        <p>詳細內容</p>
        <div class ="ui form">
            <div class="fields">
                <div class="four wide field">
                    <label>專案成員</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
                <div class="four wide field">
                    <label>部門</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
                <div class="eight wide field">
                    <label>項目名稱</label>
                    <input placeholder="Read Only" readonly="" type="text">
                </div>
            </div>
        </div>
    </div>
</div>


<div class="append專案詳細Form"></div>


    @section script{
        <script>
            //console.log(decodeURI(document.cookie.split('Name=')[1].split('&')[0]));
            //console.log(decodeURI(document.cookie.split('id=')[1].split('&')[0]));

            $('.menu .item').tab();

            appendPjList();

            function appendPjList() {               
                $.ajax({
                    url: '/projectControl/pj專案列表',
                    method: 'get',
                    success: function (data) {
                        $('#pjListView').html(`
                            <table class="ui selectable celled table">
                                <thead>
                                    <tr>
                                        <th>專案名稱</th>
                                        <th>專案經理</th>
                                        <th>概要</th>
                                        <th>詳細</th>
                                        <th>規劃</th>
                                    </tr>
                                </thead>
                                <tbody class="append專案列表內容"></tbody>
                            </table>
                        `);
                        $(data).each(function (index, item) {
                            $('.append專案列表內容').append(`
                                <tr>
                                    <td>${item.pjName}</td>
                                    <td>${item.pjManager}</td>
                                    <td>${item.pjIntroduction}</td>
                                    <td class="selectable">
                                        <a href="#" onclick="show專案細項()">Edit</a>
                                    </td>
                                    <td class="selectable">
                                        <a href="#" onclick="pj規劃()" data-id="${item.pjId}">Edit</a>
                                    </td>
                                </tr> 
                            `)
                            pj規劃 = function () {
                                //console.log($(event.currentTarget).data('id'));
                                var id = $(event.currentTarget).data('id');
                                $('.bigTab專案列表').toggleClass('active');
                                $('#pjListView').toggleClass('active');
                                $('.bigTab專案控管').toggleClass('active');                                
                                $('#tab專案控管').toggleClass('active');
                                $('#tab專案規劃').addClass('active');
                                //$('#content專案規劃').toggleClass('active');
                                $.ajax({
                                    url: "/projectControl/getPjProjectDataFromId",
                                    method: "get",
                                    data: { 'id': id},
                                    success: function (data) {
                                        //console.log(data.pjMemberCount);
                                        var id = data.pjId;
                                        var memberCount = data.pjMemberCount;
                                        $('.addPlan').html(`
                                            <div class="ui form">
                                                <div class="fields">
                                                    <div class="three wide field">
                                                        <label>專案名稱</label>
                                                        <input type="text" placeholder="First Name" value="${data.pjName}">
                                                    </div>
                                                    <div class="two wide field">
                                                        <label>專案階段</label>
                                                        <select class="ui dropdown">
                                                            <option value="" hidden>------</option>
                                                            <option value="第一階段">第一階段</option>
                                                            <option value="第二階段">第二階段</option>
                                                            <option value="第三階段">第三階段</option>
                                                            <option value="第四階段">第四階段</option>
                                                        </select>
                                                    </div>
                                                    <div class="five wide field"></div>
                                                    <div class="six wide field"></div>
                                                </div>
                                                <div class="appendPjMemberJob"></div>                                                               
                                                <div class="fields mt-3">
                                                    <div class="thirteen wide field d-flex justify-content-end">
                                                        <button class="ui inverted red button">取消</button>
                                                        <button class="ui inverted primary button">確認</button>
                                                    </div>
                                                    <div class="three wide field d-flex"></div>
                                                </div>
                                            </div>
                                        `);
                                        for (var i = 1; i <= memberCount; i++) {
                                            $('.appendPjMemberJob').append(`
                                                <div class="fields">
                                                    <div class="two wide field">
                                                        <label>成員姓名</label>
                                                        <input type="text" placeholder="Last Name" class="pjMemberName規劃" id="pjMemberName規劃${i}">
                                                    </div>
                                                    <div class="one wide field">
                                                        <label>部門</label>
                                                        <input type="text" placeholder="First Name">                                                
                                                    </div>
                                                    <div class="two wide field">
                                                        <label>專案項目</label>
                                                        <input type="text" placeholder="Last Name">
                                                    </div>
                                                    <div class="three wide field">
                                                        <label>階段目標</label>
                                                        <input type="text" placeholder="Last Name">
                                                    </div>
                                                    <div class="two wide field">
                                                        <label>開始時間</label>
                                                        <input type="date" placeholder="Last Name">
                                                    </div>
                                                    <div class="two wide field">
                                                        <label>結束時間</label>
                                                        <input type="date" placeholder="Last Name">
                                                    </div>
                                                    <div class="one wide field">
                                                        <label>工作天數</label>
                                                        <input type="text" placeholder="Last Name">
                                                    </div>                
                                                    <div class="three wide field"></div>
                                                </div>                        
                                            `);
                                        }
                                        $.ajax({
                                            url: '/projectControl/getPjTeamDataFromId',
                                            method: 'get',
                                            data: { 'id': id },
                                            success: function (data) {                                                
                                                $(data).each(function (index, item) {
                                                    console.log(item.pjId);
                                                    console.log(memberCount);
                                                    console.log(item.pjMemberName);
                                                    //$('.pjMemberName規劃').val(item.pjMemberName);
                                                })
                                            }
                                        })
                                    }
                                });
                                
                            }
                            show專案細項 = function () {
                                $('.append專案詳細Form').html(`
                                    <div class="ui small modal centermodal" id="pjDetailaaa">
                                        <div class="actions d-flex justify-content-center">
                                            <div class="ui primary button" id="pj專案規劃">規劃</div>
                                            <div class="ui grey button ml-3" id="pj專案進度">進度</div>        
                                            <div class="ui red deny button">取消</div>
                                            <div class="ui positive right labeled icon button" style="width:135px">確認<i class="checkmark icon"></i></div>
                                        </div>
                                    </div>
                                `)
                                $('#pjDetailaaa').modal('show');
                                $('#pj專案規劃').click(function () {
                                    console.log('123');
                                    //$('.bigTab專案控管').toggleClass('active');
                                    //$('.bigTab專案列表').toggleClass('active');
                                    //$('bigTab專案控管').attr('hidden', false);
                                })
                                $('#pj專案進度').click(function () {
                                    console.log('444');
                                })
                            }                            
                        })
                    }
                })                
            };

            
            
            $('#tab建立初審').click(function () {
                $('#content建立初審').html("");
                $('#content建立初審').append(`
                           <form class="ui form content建立初審Form">
                        <div class="fields">
                            <div class="five wide field">
                                <label>專案名稱</label>
                                <input type="text" placeholder="專案名稱" class="cr8專案名稱">
                            </div>
                            <div class="one wide field"></div>
                            <div class="five wide field">
                                <label>專案預算</label>
                                <input type="text" placeholder="專案預算" class="cr8專案預算">
                            </div>
                            <div class="five wide field"></div>
                        </div>
                        <div class="fields">
                            <div class="five wide field">
                                <label>專案簡介</label>
                                <input type="text" placeholder="專案簡介" class="cr8專案簡介">
                            </div>
                            <div class="one wide field"></div>
                            <div class="five wide field">
                                <label>專案成員數</label>
                                <input type="text" placeholder="專案成員數" class="cr8專案成員數">
                            </div>
                            <div class="five wide field"></div>
                        </div>
                        <div class="fields">
                            <div class="five wide field">
                                <label>專案經理</label>
                                <input type="text" placeholder="" class="cr8專案經理" value="${decodeURI(document.cookie.split('Name=')[1].split('&')[0])}">
                            </div>
                            <div class="one wide field"></div>
                            <div class="two wide field">
                                <label>開始日期</label>
                                <input type="date" placeholder="" class="cr8開始日期" id="pj初審Cr8startDate">
                            </div>
                            <div class="two wide field">
                                <label>結束日期</label>
                                <input type="date" placeholder="" class="cr8結束日期" id="pj初審Cr8endDate">
                            </div>
                            <div class="one wide field">
                                <label>預估時間</label>
                                <input type="text" placeholder="" class="cr8預估時間" readonly>
                            </div>
                            <div class="five wide field"></div>
                        </div>
                        <div class="fields">
                            <div class="five wide field">
                                <label>專案客戶</label>
                                <input type="text" placeholder="" class="cr8專案客戶">
                            </div>
                            <div class="one wide field">
                                <input type="text" hidden class="cr8pjManagerId" value="${decodeURI(document.cookie.split('id=')[1].split('&')[0])}">
                                <input type="text" hidden class="cr8pj初審結果" value="待審核">
                                <input type="text" hidden class="cr8pj審核階段" value="初審">
                            </div>
                            <div class="five wide field"></div>
                            <div class="five wide field"></div>
                        </div>
                        <div class="fields mt-3">
                            <div class="eleven wide field d-flex justify-content-end">
                                <button class="ui inverted red button" onclick="resetform()">重置</button>
                                <button class="ui inverted primary button cr8pjSubmit">確認</button>
                                <button type="reset" hidden id="theReset"></button>
                            </div>
                            <div class="five wide field d-flex"></div>
                        </div>
                    </form>
                        `);
                $('#pj初審Cr8startDate,#pj初審Cr8endDate').blur(function () {
                    if ($('#pj初審Cr8startDate').val() != '' && $('#pj初審Cr8endDate').val() != '') {
                        //sDate = new Date($('#pj初審Cr8startDate').val());
                        //eDate = new Date($('#pj初審Cr8endDate').val());
                        //days初審 = eDate.getTime() - sDate.getTime();
                        days初審 = new Date($('#pj初審Cr8startDate').val()).getTime() - new Date($('#pj初審Cr8endDate').val()).getTime();
                        //console.log(days初審);
                        var dateDiff初審 = Math.floor(days初審 / 1000 / 60 / 60 / 24 - 1); //floor,ceil
                        //console.log(dateDiff初審);
                        if (dateDiff初審 < 0) {
                            //Math.abs(dateDiff初審)
                            //console.log(Math.abs(dateDiff初審))
                            $('.cr8預估時間').val(`${Math.abs(dateDiff初審)}天`);
                        }
                        else {
                            //console.log('123');
                            $('.cr8預估時間').val('');
                            window.alert('請選擇正確的日期');
                        }
                    }
                });
                $('.cr8pjSubmit').click(function () {
                    //console.log($('.cr8預估時間').val());
                    $.ajax({
                        url: "/projectControl/getCr8formVal",
                        method: "post",
                        data: {
                            'pjName': $('.cr8專案名稱').val(),
                            'pjBudget': $('.cr8專案預算').val(),
                            'pjIntroduction': $('.cr8專案簡介').val(),
                            'pjMemberCount': $('.cr8專案成員數').val(),
                            'pjManager': $('.cr8專案經理').val(),
                            'pj開始日期': $('.cr8開始日期').val(),
                            'pj結束日期': $('.cr8結束日期').val(),
                            'pj預估時間': $('.cr8預估時間').val(),
                            'pjClient': $('.cr8專案客戶').val(),
                            'pjManagerId': $('.cr8pjManagerId').val(),
                            'pj初審結果': $('.cr8pj初審結果').val(),
                            'pj審核階段': $('.cr8pj審核階段').val(),
                        },
                        success: function () {
                            alert('成功新增資料');
                            $('#tab建立初審').toggleClass('active');
                            $('#content建立初審').toggleClass('active');
                            $('#content專案建立審核').toggleClass('active');
                            $('#tab專案建立審核').toggleClass('active');
                            //refresh(); 做一個刷新頁面仔入新增的資料
                        }
                    });
                })
            });
            function resetform() {
                $('#theReset').click();
            }


            $('.bigTab建立專案').click(function () {
                //$('.appendPjDataFromSql-tb').html('wooow');
                $.ajax({
                    url: "/projectControl/getPjProjectData",
                    method: "get",
                    success: function (data) {
                        if (data.length == 0) {
                            console.log('123');
                            $('.pj專案建立審核沒有建立中專案').html(`
                                    <div class="d-flex justify-content-center mt-5 mb-5">
                                        <p>目前沒有建立中的專案</p>
                                    </div>
                                `);
                        } else {

                            $.ajax({//總表
                                url: "/projectControl/getPjProjectData",
                                method: "get",
                                success: function (data) { 
                                    $('.appendPjDataFromSql-th').html(`
                                        <tr>
                                            <th>專案名稱</th>
                                            <th>專案負責人</th>

                                            <th>審核階段</th>
                                            <th>審核結果</th>
                                            <th>詳細資訊</th>
                                 
                                      
                                        </tr>
                                    `);     
                                    $('.appendPjDataFromSql-tb').html("");
                                    $(data).each(function (index, item) {
                                        $('.appendPjDataFromSql-tb').append(`
                                            <tr>
                                                <td>${item.pjName}</td>
                                                <td>${item.pjManager}</td>
                                                <td>${item.pj審核階段}</td>
                                                <td>${item.pj初審結果}</td>
                           <td class="selectable"><a href="#" onclick="pj初審詳細()" data-id="${item.pjId}">初審詳細</a></td>
                                                
                                            </tr>`
                                        )
                                    })

                                }

                            })
                   
                            $.ajax({ //複審審核
                                url: "/projectControl/getPjProjectDatat2",
                                method: "get",
                                success: function (data) {
                            $('.appendPjDataFromSql-th2').html(`
                                        <tr>
                                            <th>專案名稱</th>
         <th>專案負責人</th>
                                            <th>審核階段</th>
                                            <th>審核結果</th>
                                       
                                          
                                            <th>複審審核</th>
                                        </tr>
                                    `);     
                            $('.appendPjDataFromSql-tb2').html("");
                            $(data).each(function (index, item) {
                                $('.appendPjDataFromSql-tb2').append(`
                                            <tr>
                                                <td>${item.pjName}</td>
        <td>${item.pjManager}</td>
                                                <td>${item.pj審核階段}</td>
                                                <td>${item.pj初審結果}</td>
                                                
                                               
                                                <td class="selectable"><a href="#" onclick="pj複審審核()" data-id="${item.pjId}">複審審核</a></td>
                                            </tr>`
                                )
                            })
                                }

                            })
                            $.ajax({ //初審審核
                                url: "/projectControl/getPjProjectDatat3",
                                method: "get",
                                success: function (data) {


                            $('.appendPjDataFromSql-th3').html(`
                                        <tr>
                                            <th>專案名稱</th>
         <th>專案負責人</th>
                                            <th>審核階段</th>
                                            <th>審核結果</th>
                                            <th>重新送審</th>
                                            <th>初審審核</th>
                                      
                                        </tr>
                                    `);     
                            $('.appendPjDataFromSql-tb3').html("");
                            $(data).each(function (index, item) {
                                $('.appendPjDataFromSql-tb3').append(`
                                            <tr>
                                                <td>${item.pjName}</td>
        <td>${item.pjManager}</td>
                                                <td>${item.pj審核階段}</td>
                                                <td>${item.pj初審結果}</td>
                                          <td class="selectable"><a href="#" onclick="pj重新送審()" data-id="${item.pjId}">重新送審</a></td>
                                                  <td class="selectable"><a href="#" onclick="pj初審審核()" data-id="${item.pjId}">查看更多</a></td>
                                                
                                            </tr>`
                                )
                            })

                                }

                            })

                            $.ajax({//初審ok
                                url: "/projectControl/getPjProjectDatat4",
                                method: "get",
                                success: function (data) {
 
                            $('.appendPjDataFromSql-th4').html(`
                                        <tr>
                                            <th>專案名稱</th>
         <th>專案負責人</th>
                                            <th>審核階段</th>
                                            <th>審核結果</th>
                                          
                                            <th>建立複審</th>
                                      
                                        </tr>
                                    `);      
                            $('.appendPjDataFromSql-tb4').html("");
                            $(data).each(function (index, item) {
                                $('.appendPjDataFromSql-tb4').append(`
                                            <tr>
                                                <td>${item.pjName}</td>
        <td>${item.pjManager}</td>
                                                <td>${item.pj審核階段}</td>
                                                <td>${item.pj初審結果}</td>
                                               
                                                <td class="selectable"><a href="#" class="pj建立複審" data-id="${item.pjId}">建立複審</a></td>
                                                
                                            </tr>`
                                )
                            })

                                    $('.pj建立複審').click(function () {
                                        var id = $(event.currentTarget).data('id');
                                        console.log(id);
                                        $.ajax({
                                            url: "/projectControl/getPjProjectDataFromId",
                                            method: "post",
                                            data: { "id": id },
                                            success: function (data) {
                                                //console.log(data.pjMemberCount);
                                                $('#tab專案建立審核').toggleClass('active');
                                                $('#content專案建立審核').toggleClass('active');
                                                $('#tab建立複審').toggleClass('active');
                                                $('#content建立複審').toggleClass('active');
                                                $('#tab建立複審').attr('hidden', false);
                                                var membersCount = data.pjMemberCount;
                                                //console.log(membersCount);
                                                $('#content建立複審').html("");

                                                for (var i = 1; i <= membersCount; i++) {
                                                    $('#content建立複審').append(`
                                                        <form class="ui form" id="cr8form${i}">
                                                            <div class="fields">
                                                                <div class="two wide field">
                                                                    <label>部門</label>
                                                                    <select class="ui search dropdown" id="pjCr8複審部門${i}" name="pjMember部門">
                                                                        <option value="">部門</option>
                                                                        <option value="資訊部">資訊部</option>
                                                                        <option value="人事部">人事部</option>
                                                                        <option value="總務部">總務部</option>
                                                                        <option value="財務部">財務部</option>
                                                                        <option value="業務部">業務部</option>
                                                                    </select>
                                                                </div>
                                                                <div class="four wide field">
                                                                    <label>成員姓名</label>
                                                                    <input type="text" placeholder="成員姓名" name="pjMemberName">
                                                                </div>
                                                                <div class="five wide field">
                                                                    <label>專案項目</label>
                                                                    <input type="text" placeholder="專案項目" name="pjTarget">
                                                                </div>
                                                                <div class="one wide field">
                                                                    <input type="text" hidden id="審核階段" value="複審">
                                                                </div>
                                                                <div class="one wide field">
                                                                    <input type="text" hidden name="pjId" value="${data.pjId}">
                                                                </div>
                                                                <div class="four wide field"></div>
                                                            </div>
                                                        </form>
                                                    `)
                                                }
                                                $('.change審核階段').click(function () {
                                                   
                                                })
                                                $('#content建立複審').append(`
                                                    <div class="ui form">
                                                        <div class="eleven wide field d-flex justify-content-end">
                                                            <button class="ui inverted red button">取消</button>
                                                            <button class="ui inverted primary button" id="submitCr8preview2">確認</button>
                                                        </div>
                                                        <div class="five wide field"></div>
                                                    </div>
                                                `)
                                                $('#submitCr8preview2').click(function () {
                                                    $.ajax({
                                                        url: "/projectControl/getPjProjectDataFromIdto2",
                                                        method: "get",
                                                        data: {
                                                            "id": id,
                                                        },
                                                        success: function () {
                                                            console.log('47438');
                                                        }                                                        
                                                    })
                                                    for (var i = 1; i <= membersCount; i++) {
                                                        console.log($(`#pjCr8複審部門${i} option:selected`).val());
                                                        console.log(document.querySelector(`#cr8form${i}`));
                                                        var formdata = new FormData(document.querySelector(`#cr8form${i}`));
                                                        $.ajax({
                                                            url: "/projectControl/savePreview2FormData",
                                                            method: "post",
                                                            data: formdata,
                                                            processData: false,
                                                            contentType: false,
                                                            success: function () {
                                                            }
                                                        })
                                                    }
                                                    window.alert('存進去了啦');
                                                    $('#tab建立複審').attr('hidden', true);
                                                    $('#tab建立複審').toggleClass('active');
                                                    $('#content建立複審').toggleClass('active');
                                                    $('#tab專案建立審核').toggleClass('active');
                                                    $('#content專案建立審核').toggleClass('active');
                                                })
                                                $(document).on('click', 'div', function () {
                                                    if ($('#content建立複審 .active').attr('data-tab') != 'second/c') {
                                                        //console.log($('.active ').attr('data-tab'));
                                                        $('#tab建立複審').attr('hidden', true);
                                                        //$('#content建立複審').toggleClass('active');
                                                        //$('#tab建立複審').toggleClass('active');
                                                    }
                                                    else {
                                                        //console.log($('.active ').attr('data-tab'));
                                                        //$('#content建立複審').toggleClass('active');
                                                        //$('#tab建立複審').toggleClass('active');
                                                        $('#tab建立複審').attr('hidden', false);
                                                    }
                                                })
                                            }
                                        })
                                    })

                                  
                                }

                            })
                            pj初審詳細 = function () {
                                var id = $(event.currentTarget).data('id');
                                console.log(id);
                                //$('#pj初審單').modal('show');
                                $.ajax({
                                    url: "/projectControl/getPjProjectDataFromId",
                                    method: "post",
                                    data: { 'id': id },
                                    success: function (data) {
                                        console.log(data.pjId);
                                        //console.log(data.pj開始日期);
                                        //var a = new Date(1618761600000);
                                        //console.log(a);
                                        //var b = data.pj開始日期.replace(/[^0-9]/ig, "");
                                        //console.log(b);
                                        var return開始日期 = new Date(parseInt(data.pj開始日期.replace(/[^0-9]/ig, "")));
                                        //console.log(return開始日期.getFullYear());
                                        //console.log(return開始日期.getMonth());
                                        //console.log(return開始日期.getDay());
                                        //console.log(return開始日期.getDate());
                                        var retuenEndDate = new Date(parseInt(data.pj結束日期.replace(/[^0-9]/ig, "")));
                                        var return結束日期 = `${retuenEndDate.getFullYear()}/${retuenEndDate.getMonth() + 1}/${retuenEndDate.getDate()}`;
                                        $('.pj初審單header').html(`${data.pjName}`);
                                        $('.pj初審單資料').html(`
                                            <div class="ui form">
                                                <div class="two fields">
                                                    <div class="field">
                                                        <label>專案經理</label>
                                                        <input value="${data.pjManager}" readonly type="text"id="pjManager">
                                                    </div>
                                                    <div class="field">
                                                        <label>專案簡介</label>
                                                        <input value="${data.pjIntroduction}" readonly type="text" id="pjIntroduction">
                                                    </div>
                                                </div>
                                                <div class="two fields">
                                                    <div class="field">
                                                        <label>專案客戶</label>
                                                        <input value="${data.pjClient}" readonly type="text"id="pjClient">
                                                    </div>
                                                    <div class="field">
                                                        <label>專案預算</label>
                                                        <input value="${data.pjBudget}" readonly type="text"id="pjBudget">
                                                    </div>
                                                </div>
                                                <div class="three fields">
                                                    <div class="field">
                                                        <label>開始日期</label>
                                                        <input value="${return開始日期.getFullYear()}/${return開始日期.getMonth() + 1}/${return開始日期.getDate()}" readonly type="text"id="開始日期">
                                                    </div>
                                                    <div class="field">
                                                        <label>結束日期</label>
                                                        <input value="${return結束日期}" readonly type="text"id="結束日期">
                                                    </div>
                                                    <div class="field">
                                                        <label>預估時間</label>
                                                        <input value="${data.pj預估時間}" readonly type="text"id="pj預估時間">
                                                    </div>
                                                    <div class="field">
                                                        <label>專案成員數</label>
                                                        <input value="${data.pjMemberCount}" readonly type="text"id="pjMemberCount">
                                                    </div>
                                                    <div class="field" hidden>
                                                        <label></label>
                                                        <input value="${data.pjManagerId}" readonly type="text"id="pjManagerId">
                                                    </div>
                                                     <div class="field" hidden>
                                                        <label></label>
                                                        <input value="${data.pj審核階段}" readonly type="text"id="pj審核階段">
                                                    </div>
                                                </div>            
                                            </div>
                                            <div class="ui form">
                                              
                                                <div class="three fields mb-5">
                                                    
                                                 
                                                    <div class="field"></div>                
                                                </div>
            
                                                <div class="d-flex justify-content-end">
                                                    <div>
                                                     

                                                        <button class="ui inverted primary button mt-1 " data-id="${data.pjId}">確認</button>
                                                    </div>
                                                </div>
                                            </div>
                                        `);
                                        $('#pj初審單').modal('show');
                                    
                                 
                                    }
                                })
                            }  
                            pj初審審核 = function () {
                                var id = $(event.currentTarget).data('id');
                                console.log(id);
                                //$('#pj初審單').modal('show');
                                $.ajax({
                                    url: "/projectControl/getPjProjectDataFromId",
                                    method: "post",
                                    data: { 'id': id },
                                    success: function (data) {
                                        console.log(data.pjId);
                                        //console.log(data.pj開始日期);
                                        //var a = new Date(1618761600000);
                                        //console.log(a);
                                        //var b = data.pj開始日期.replace(/[^0-9]/ig, "");
                                        //console.log(b);
                                        var return開始日期 = new Date(parseInt(data.pj開始日期.replace(/[^0-9]/ig, "")));
                                        //console.log(return開始日期.getFullYear());
                                        //console.log(return開始日期.getMonth());
                                        //console.log(return開始日期.getDay());
                                        //console.log(return開始日期.getDate());
                                        var retuenEndDate = new Date(parseInt(data.pj結束日期.replace(/[^0-9]/ig, "")));
                                        var return結束日期 = `${retuenEndDate.getFullYear()}/${retuenEndDate.getMonth() + 1}/${retuenEndDate.getDate()}`;
                                        $('.pj初審單header').html(`${data.pjName}`);
                                        $('.pj初審單資料').html(`
                                            <div class="ui form">
                                                <div class="two fields">
                                                    <div class="field">
                                                        <label>專案經理</label>
                                                        <input value="${data.pjManager}" readonly type="text"id="pjManager">
                                                    </div>
                                                    <div class="field">
                                                        <label>專案簡介</label>
                                                        <input value="${data.pjIntroduction}" readonly type="text" id="pjIntroduction">
                                                    </div>
                                                </div>
                                                <div class="two fields">
                                                    <div class="field">
                                                        <label>專案客戶</label>
                                                        <input value="${data.pjClient}" readonly type="text"id="pjClient">
                                                    </div>
                                                    <div class="field">
                                                        <label>專案預算</label>
                                                        <input value="${data.pjBudget}" readonly type="text"id="pjBudget">
                                                    </div>
                                                </div>
                                                <div class="three fields">
                                                    <div class="field">
                                                        <label>開始日期</label>
                                                        <input value="${return開始日期.getFullYear()}/${return開始日期.getMonth() + 1}/${return開始日期.getDate()}" readonly type="text"id="開始日期">
                                                    </div>
                                                    <div class="field">
                                                        <label>結束日期</label>
                                                        <input value="${return結束日期}" readonly type="text"id="結束日期">
                                                    </div>
                                                    <div class="field">
                                                        <label>預估時間</label>
                                                        <input value="${data.pj預估時間}" readonly type="text"id="pj預估時間">
                                                    </div>
                                                    <div class="field">
                                                        <label>專案成員數</label>
                                                        <input value="${data.pjMemberCount}" readonly type="text"id="pjMemberCount">
                                                    </div>
                                                    <div class="field" hidden>
                                                        <label></label>
                                                        <input value="${data.pjManagerId}" readonly type="text"id="pjManagerId">
                                                    </div>
                                                     <div class="field" hidden>
                                                        <label></label>
                                                        <input value="${data.pj審核階段}" readonly type="text"id="pj審核階段">
                                                    </div>
                                                </div>            
                                            </div>
                                            <div class="ui form">
                                                <div class="field">
                                                    <label>意見內容</label>
                                                    <textarea type="text" placeholder="First Name" id="pj意見內容"></textarea>
                                                </div>
                                                <div class="three fields mb-5">
                                                    <div class="field">
                                                        <label>審核結果</label>
                                                        <select class="ui dropdown" name="pj初審結果" id="pj初審結果">
                                                            <option value="" hidden>待審核</option>
                                                            <option value="通過">通過</option>
                                                            <option value="不通過">不通過</option>
                                                        </select>
                                                    </div>
                                                    <div class="field">
                                                        <label>審核人員</label>
                                                        <input type="text"/>
                                                    </div>
                                                    <div class="field"></div>                
                                                </div>
            
                                                <div class="d-flex justify-content-end">
                                                    <div>
                                                        <button class="ui inverted red button">取消</button>

                                                        <button class="ui inverted primary button mt-1 pj初審結果 初審審核" data-id="${data.pjId}">確認</button>
                                                    </div>
                                                </div>
                                            </div>
                                        `);
                                        $('#pj初審單').modal('show');
                                        $('.pj初審結果').click(function () {    
                                            var id = $(event.currentTarget).data('id');
                                            console.log(id);
                                            console.log($(`#pj初審結果 option:selected`).val());
                                            $.ajax({
                                                url: '/projectControl/pj審核結果儲存',
                                                method: 'post',
                                                data: {
                                                    'pjId': id,
                                                    'pj初審結果': $(`#pj初審結果 option:selected`).val(),
                                                    'pjManager': $(`#pjManager`).val(),
                                                    'pjIntroduction': $(`#pjIntroduction`).val(),
                                                    'pjClient': $(`#pjClient`).val(),
                                                    'pjBudget': $(`#pjBudget`).val(),
                                                    'pj開始日期': $(`#開始日期`).val(),
                                                    'pj結束日期': $(`#結束日期`).val(),
                                                    'pjadvice': $(`#pjadvice`).val(),
                                                    'pj預估時間': $(`#pj預估時間`).val(),
                                                    'pjName': `${data.pjName}`,
                                                    'pjManagerId': $(`#pjManagerId`).val(),
                                                    
                                                    'pjMemberCount': $(`#pjMemberCount`).val(),
                                                    'pj審核階段': $(`#pj審核階段`).val(),
                                                   
                                                },
                                                success: function () {
                                                    window.alert('success')
                                                }
                                            });
                                        })
                                        $('.初審審核').click(function () {
                                            $.ajax({
                                                url: '/projectControl/pj審核意見',
                                                method: 'post',
                                                data: {
                                                    'pjId': id,
                                                  
                                                    'pj審核階段': `${data.pj審核階段}`,
                                                    'pj意見內容': $(`#pj意見內容`).val(),

                                                },
                                                success: function () {
                                                    window.alert('success')
                                                }
                                            });
                                        })
                                    }
                                })
                            }  
                            pj複審審核 = function () {
                                var id = $(event.currentTarget).data('id');
                                console.log(id);
                                $('#pj複審單').modal('show');
                                //$.ajax({
                                //    url: "",
                                //    method: "post",
                                //    data: { "id": id },
                                //    success: function () { }
                                //})
                            }
                            pj重新送審 = function () {
                                var id = $(event.currentTarget).data('id');
                                console.log(id);
                                //$('#pj初審單').modal('show');
                                $.ajax({
                                    url: "/projectControl/getPjProjectDataFromId",
                                    method: "post",
                                    data: { 'id': id },
                                    success: function (data) {
                                        console.log(data.pjId);
                                        //console.log(data.pj開始日期);
                                        //var a = new Date(1618761600000);
                                        //console.log(a);
                                        //var b = data.pj開始日期.replace(/[^0-9]/ig, "");
                                        //console.log(b);
                                        var return開始日期 = new Date(parseInt(data.pj開始日期.replace(/[^0-9]/ig, "")));
                                        //console.log(return開始日期.getFullYear());
                                        //console.log(return開始日期.getMonth());
                                        //console.log(return開始日期.getDay());
                                        //console.log(return開始日期.getDate());
                                        var retuenEndDate = new Date(parseInt(data.pj結束日期.replace(/[^0-9]/ig, "")));
                                        var return結束日期 = `${retuenEndDate.getFullYear()}/${retuenEndDate.getMonth() + 1}/${retuenEndDate.getDate()}`;
                                        $('.pj初審單header').html(`${data.pjName}`);
                                        $('.pj初審單資料').html(`
                                            <div class="ui form">
                                                <div class="two fields">
                                                    <div class="field">
                                                        <label>專案經理</label>
                                                        <input value="${data.pjManager}"  type="text"id="pjManager">
                                                    </div>
                                                    <div class="field">
                                                        <label>專案簡介</label>
                                                        <input value="${data.pjIntroduction}"  type="text" id="pjIntroduction">
                                                    </div>
                                                </div>
                                                <div class="two fields">
                                                    <div class="field">
                                                        <label>專案客戶</label>
                                                        <input value="${data.pjClient}"  type="text"id="pjClient">
                                                    </div>
                                                    <div class="field">
                                                        <label>專案預算</label>
                                                        <input value="${data.pjBudget}"  type="text"id="pjBudget">
                                                    </div>
                                                </div>
                                                <div class="three fields">
                                                    <div class="field">
                                                        <label>開始日期</label>
                                                        <input value="${return開始日期.getFullYear()}/${return開始日期.getMonth() + 1}/${return開始日期.getDate()}"  type="date" id=" pj初審Cr8startDate" class="開始日期">
                                                    </div>
                                                    <div class="field">
                                                        <label>結束日期</label>
                                                        <input value="${return結束日期}"  type="text"id="結束日期">
                                                    </div>
                                                    <div class="field">
                                                        <label>預估時間</label>
                                                        <input value="${data.pj預估時間}"  type="text"id="pj預估時間">
                                                    </div>
                                                    <div class="field">
                                                        <label>專案成員數</label>
                                                        <input value="${data.pjMemberCount}"  type="text"id="pjMemberCount">
                                                    </div>
                                                    <div class="field" hidden>
                                                        <label></label>
                                                        <input value="${data.pjManagerId}"  type="text"id="pjManagerId">
                                                    </div>
                                                     <div class="field" hidden>
                                                        <label></label>
                                                        <input value="${data.pj審核階段}"  type="text"id="pj審核階段">
                                                    </div>
                                                </div>            
                                            </div>
                                 
                                          
                              
                                           
                                                    
                                  
                            
                              
            
                                                <div class="d-flex justify-content-end">
                                                    <div>
                                                        <button class="ui inverted red button">取消</button>

                                                        <button class="ui inverted primary button mt-1 pj重新送審 " data-id="${data.pjId}">確認</button>
                                                    </div>
                                                </div>
                                            </div>
                                        `);
                                        $('#pj初審單').modal('show');
                                        $('.pj重新送審').click(function () {
                                            var id = $(event.currentTarget).data('id');
                                            console.log(id);
                                            console.log($(`#pj初審結果 option:selected`).val());
                                            $.ajax({
                                                url: '/projectControl/pj審核結果儲存',
                                                method: 'post',
                                                data: {
                                                    'pjId': id,
                                                    'pj初審結果':"未審核",
                                                    'pjManager': $(`#pjManager`).val(),
                                                    'pjIntroduction': $(`#pjIntroduction`).val(),
                                                    'pjClient': $(`#pjClient`).val(),
                                                    'pjBudget': $(`#pjBudget`).val(),
                                                    'pj開始日期': $(`.開始日期`).val(),
                                                    'pj結束日期': $(`#結束日期`).val(),
                                                    'pjadvice': $(`#pjadvice`).val(),
                                                    'pj預估時間': $(`#pj預估時間`).val(),
                                                    'pjName': `${data.pjName}`,
                                                    'pjManagerId': $(`#pjManagerId`).val(),

                                                    'pjMemberCount': $(`#pjMemberCount`).val(),
                                                    'pj審核階段': "初審",

                                                },
                                                success: function () {
                                                    window.alert('success')
                                                }
                                            });
                                        })
                                        $('.pj初審結果').click(function () {
                                            var id = $(event.currentTarget).data('id');
                                            console.log(id);
                                            console.log($(`#pj初審結果 option:selected`).val());
                                            $.ajax({
                                                url: '/projectControl/pj審核結果儲存',
                                                method: 'post',
                                                data: {
                                                    'pjId': id,
                                                    'pj初審結果': $(`#pj初審結果 option:selected`).val(),
                                                    'pjManager': $(`#pjManager`).val(),
                                                    'pjIntroduction': $(`#pjIntroduction`).val(),
                                                    'pjClient': $(`#pjClient`).val(),
                                                    'pjBudget': $(`#pjBudget`).val(),
                                                    'pj開始日期': $(`#開始日期`).val(),
                                                    'pj結束日期': $(`#結束日期`).val(),
                                                    'pjadvice': $(`#pjadvice`).val(),
                                                    'pj預估時間': $(`#pj預估時間`).val(),
                                                    'pjName': `${data.pjName}`,
                                                    'pjManagerId': $(`#pjManagerId`).val(),

                                                    'pjMemberCount': $(`#pjMemberCount`).val(),
                                                    'pj審核階段': $(`#pj審核階段`).val(),

                                                },
                                                success: function () {
                                                    window.alert('success')
                                                }
                                            });
                                        })
                                        $('.初審審核').click(function () {
                                            $.ajax({
                                                url: '/projectControl/pj審核意見',
                                                method: 'post',
                                                data: {
                                                    'pjId': id,

                                                    'pj審核階段': `${data.pj審核階段}`,
                                                    'pj意見內容': $(`#pj意見內容`).val(),

                                                },
                                                success: function () {
                                                    window.alert('success')
                                                }
                                            });
                                        })
                                    }
                                })
                            }  
                            $('.pj建立複審').click(function () {
                                var id = $(event.currentTarget).data('id');
                                console.log(id);
                                $.ajax({
                                    url: "/projectControl/getPjProjectDataFromId",
                                    method: "post",
                                    data: { "id": id },
                                    success: function (data) {
                                        //console.log(data.pjMemberCount);
                                        $('#tab專案建立審核').toggleClass('active');
                                        $('#content專案建立審核').toggleClass('active');
                                        $('#tab建立複審').toggleClass('active');
                                        $('#content建立複審').toggleClass('active');
                                        $('#tab建立複審').attr('hidden', false);
                                        var membersCount = data.pjMemberCount;
                                        //console.log(membersCount);
                                        $('#content建立複審').html("");
                                        for (var i = 1; i <= membersCount; i++) {
                                            $('#content建立複審').append(`
                                                        <form class="ui form" id="cr8form${i}">
                                                            <div class="fields">
                                                                <div class="two wide field">
                                                                    <label>部門</label>
                                                                    <select class="ui search dropdown" id="pjCr8複審部門${i}" name="pjMember部門">
                                                                        <option value="">部門</option>
                                                                        <option value="資訊部">資訊部</option>
                                                                        <option value="人事部">人事部</option>
                                                                        <option value="總務部">總務部</option>
                                                                        <option value="財務部">財務部</option>
                                                                        <option value="業務部">業務部</option>
                                                                    </select>
                                                                </div>
                                                                <div class="four wide field">
                                                                    <label>成員姓名</label>
                                                                    <input type="text" placeholder="成員姓名" name="pjMemberName">
                                                                </div>
                                                                <div class="five wide field">
                                                                    <label>專案項目</label>
                                                                    <input type="text" placeholder="專案項目" name="pjTarget">
                                                                </div>
                                                                   <div class="four wide field" hidden>
                                                                    <label>成員姓名</label>
                                                                    <input type="text" placeholder="審核階段" name="pjMemberName" id="pj審核階段">
                                                                </div>
                                                                <div class="one wide field">
                                                                    <input type="text" hidden name="pjId" value="${data.pjId}">
                                                                </div>
                                                                <div class="four wide field"></div>
                                                            </div>
                                                        </form>
                                                    `)
                                        }
                                        $('#content建立複審').append(`
                                                    <div class="ui form">
                                                        <div class="eleven wide field d-flex justify-content-end">
                                                            <button class="ui inverted red button">取消</button>
                                                            <button class="ui inverted primary button" id="submitCr8preview2">確認</button>
                                                        </div>
                                                        <div class="five wide field"></div>
                                                    </div>
                                                `)
                                        $('#submitCr8preview2').click(function () {
                                            for (var i = 1; i <= membersCount; i++) {
                                                console.log($(`#pjCr8複審部門${i} option:selected`).val());
                                                console.log(document.querySelector(`#cr8form${i}`));
                                                var formdata = new FormData(document.querySelector(`#cr8form${i}`));
                                                $.ajax({
                                                    url: "/projectControl/savePreview2FormData",
                                                    method: "post",
                                                    data: formdata,
                                                    processData: false,
                                                    contentType: false,
                                                    success: function () {
                                                    }
                                                })
                                            }
                                            window.alert('存進去了啦');
                                            $('#tab建立複審').attr('hidden', true);
                                            $('#tab建立複審').toggleClass('active');
                                            $('#content建立複審').toggleClass('active');
                                            $('#tab專案建立審核').toggleClass('active');
                                            $('#content專案建立審核').toggleClass('active');
                                        })
                                        $(document).on('click', 'div', function () {
                                            if ($('#content建立複審 .active').attr('data-tab') != 'second/c') {
                                                //console.log($('.active ').attr('data-tab'));
                                                $('#tab建立複審').attr('hidden', true);
                                                //$('#content建立複審').toggleClass('active');
                                                //$('#tab建立複審').toggleClass('active');
                                            }
                                            else {
                                                //console.log($('.active ').attr('data-tab'));
                                                //$('#content建立複審').toggleClass('active');
                                                //$('#tab建立複審').toggleClass('active');
                                                $('#tab建立複審').attr('hidden', false);
                                            }
                                        })
                                    }
                                })
                            })
                        }
                    }
                })
            })
        </script>
    }
